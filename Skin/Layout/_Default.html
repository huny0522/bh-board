<?php
if(_BH_ !== true) exit;
ob_start();
/**
 * @var $this BH_Controller
 */
$this->CSSAdd('jquery-ui-1.10.1.css', 10);
$this->CSSAdd('common.css', 10);
$this->CSSAdd('style.css?r='.BH_Common::Config('Default', 'Refresh'), 10);
$this->CSSAdd2(_STYLEFILE.'?r='.BH_Common::Config('Default', 'Refresh'), 10);
$this->CSSAdd('responsive.css?r='.BH_Common::Config('Default', 'Refresh'), 10);

$this->JSAdd('jquery-1.11.3.min.js', 10);
$this->JSAdd('jquery.form.min.js', 10);
$this->JSAdd('jquery-ui.min.js', 10);
$this->JSAdd('common.js?r='.BH_Common::Config('Default', 'Refresh'), 10);
?>
<?inc. '/Layout/_Header.html' ?>
<div id="wrap">
	<header id="header">
		<div id="header_wrap">
			<h1><a href="<?p. _URL ?>/"><i><img src="/Skin/images/logo.png"></i> <span>BH BOARD</span></a></h1>

			<nav id="gnb">
				<ul>
					<?php if(_MEMBERIS === true){ ?>
						<li><a href="<?p. _URL ?>/Login/Logout">로그아웃</a></li>
						<li><a href="<?p. _URL ?>/Mypage">마이페이지</a></li>
					<?php }else{ ?>
						<li><a href="<?p. _URL ?>/Login/Register">회원가입</a></li>
						<li><a href="<?p. _URL ?>/Login">로그인</a></li>
					<?php } ?>
				</ul>
			</nav>

			<style>
				#tnb{
				{ $pa; top:3.0rem; left:0; z-index:1; width:100%; padding-left:28%; font-weight:700; font-size:1.4em;}
				ol, ul{ $cb--; }
				ul{
				> li{ $fll; height:1.2em; padding:0 1.8em;}
				> li > a{ display:block; height:2.8rem; color:#222; letter-spacing:0em; transition:0.4s;}
				> li:hover > a{ letter-spacing:0.2em; color:#555;}
				> li.Active > a{ color:#37b;}
				> li.Active ol{ -webkit-transition:0.3s; -moz-transition:0.3s; -ms-transition:0.3s; -o-transition:0.3s; transition:0.3s;}
				> li.Active ol li{ background:#369 url('../images/bg02.png');}
				ol{
				{ position:absolute; top:100%; line-height:1.2em; padding-top:0; margin-left:-0.5rem;}
				li{ position:relative; float:left; font-size:0.7em; font-weight:700; color:#ccc; letter-spacing:0; transition:0.3s; padding:0 1.0rem; background:#222; transition:0.3s;overflow:hidden; height:0;}
				li:first-child{border-radius:0.85em 0 0 0.85em; padding-left:1.5rem;}
				li:last-child{border-radius:0 0.85em 0.85em 0; padding-right:1.5rem;}
				li:first-child:last-child{border-radius:0.85em;}
				li:hover{ color:#fff; letter-spacing:0.1em;}
				li.Active{ color:#fff;}
				li:before{ content:''; position:absolute; top:0.5rem; left:0; width:1px; height:1em; background:#ccc;}
				li:first-child:before{ content:none;}
				} //ol
				> li:hover ol li{ height:1.7em; border-top-width:0.1em;}
				> li.Active ol li{ height:1.7em; border-top-width:0.1em;}
				+:hover > li ol li{ height:0; border-top-width:0;}
				+:hover > li:hover ol li{ height:1.7em; border-top-width:0.1em;}
				} //ul
				} //#tnb
			</style>
			<nav id="tnb">
				<ul>
					<?php foreach(\BH_Application::Router()->MainMenu as $row){ ?>
						<li<?p. isset(\BH_Application::Router()->ActiveMenu['category']) && substr(\BH_Application::Router()->ActiveMenu['category'], 0, strlen($row['category'])) === $row['category'] ? ' class="Active"' : '' ?>>
							<a href="<?p. _URL ?>/<?v. $row['controller'] ?>"><?v. $row['title'] ?></a>
							<?php
							if(isset(\BH_Application::Router()->SubMenu[$row['category']]) && sizeof(\BH_Application::Router()->SubMenu[$row['category']])){
								echo '<ol>';
								foreach(\BH_Application::Router()->SubMenu[$row['category']] as $subMenu){
									echo '<li'.(isset(\BH_Application::Router()->ActiveMenu['category']) && substr(\BH_Application::Router()->ActiveMenu['category'], 0, strlen($subMenu['category'])) === $subMenu['category'] ? ' class="Active"' : '').'><a href="'._URL.'/'.$subMenu['controller'].'">'.GetDBText($subMenu['title']).'</a></li>';
								}
								echo '</ol>';
							}
							?>
						</li>
					<?php } ?>
				</ul>
			</nav>
		</div>
	</header>

	<div id="container">
		<div id="container_wrap">
			<?p. $_BODY ?>
		</div>
	</div>

	<footer id="footer">
		<div id="footer_wrap">
			<div id="">
			</div>
			<div id="">
			</div>
		</div>
	</footer>
</div>
	<script>
		jQuery(function($){
			$(document).ready(function(){
				$('#tnb ul > li').each(function(){
					tnbAlign(this);
				});
			});

			$(document).on('mouseenter', '#tnb ul > li', function(){
				tnbAlign(this);
			});
		});
		function tnbAlign(obj){
			var sub = $(obj).find('ol');
			if(!sub.length) return;
			var thisCenter = $(obj).offset().left + ($(obj).outerWidth() / 2);
			var subCenter = sub.offset().left + (sub.outerWidth() / 2) - parseInt(sub.css('margin-left'));
			sub.css({'margin-left' : (thisCenter - subCenter) + 'px'});
		}
	</script>

<?p. _REFRESH_BTN ?>
<?inc. '/Layout/_Footer.html' ?>
<?php
$_BODY = ob_get_clean();
